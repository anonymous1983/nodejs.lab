<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />
<title>Participez à notre Jeu Battle et gagnez plein de cadeaux</title>
<link href="/stylesheets/reset.css" rel="stylesheet" type="text/css" media="all" />
<link href="/stylesheets/layout.css" rel="stylesheet" type="text/css" media="all" />
<link href="/stylesheets/font.css" rel="stylesheet" type="text/css" media="all" />
<link href="/stylesheets/sprites.css" rel="stylesheet" type="text/css" media="all" />
<link href="/stylesheets/form.css" rel="stylesheet" type="text/css" media="all" />
<link href="/stylesheets/global.css" rel="stylesheet" type="text/css" media="all" />
<link href="/plugins/vegas/jquery.vegas.css" rel="stylesheet" type="text/css" media="all" />
<link href="/plugins/keyboard/css/keyboard.css" rel="stylesheet" type="text/css" media="all" />
<link href="/plugins/slick-quiz/css/slickQuiz.css" media="screen" rel="stylesheet" type="text/css">
<link href="/stylesheets/tunisiana.css" rel="stylesheet" type="text/css" media="all" />
<link href="/stylesheets/style.css" rel="stylesheet" type="text/css" media="all" />
<script src="/plugins/modernizr/modernizr.custom.js"></script>
<script src="/plugins/respond/respond.js"></script>
</head>

<body class="tunisiana bg-tunisiana-s2">
<div id="tk-content" class="tk-content">
<div id="frame-1" class="frame frame-1 next-frame" data-frame="1">
  <ul id="menu-vegaz">
    <li><a href="/background-1.png" data-valign="top"><img src="/thumbnail-1.jpg"></a></li>
    <li><a href="/background-2.png" data-valign="top"><img src="/thumbnail-2.jpg"></a></li>
    <li><a href="/background-3.png" data-valign="top"><img src="/thumbnail-1.jpg"></a></li>
    <li><a href="/background-1.png" data-valign="top"><img src="/thumbnail-1.jpg"></a></li>
    <li><a href="/background-2.png" data-valign="top"><img src="/thumbnail-2.jpg"></a></li>
    <li><a href="/background-3.png" data-valign="top"><img src="/thumbnail-1.jpg"></a></li>
    <li><a href="/background-1.png" id="slideshow"><span id="pause"></span><img id="thumbnail" src="/slideshow.gif"></a></li>
    <li><a href="/background-1.png" id="slideshow"><span id="pause"></span><img id="thumbnail" src="/slideshow.gif"></a></li>
  </ul>

</div>
<div id="frame-2" class="frame frame-2 next-frame" data-frame="1">

  <div class="frame-header tk-header">
      <div class="logo-ooredoo"></div>
      <div class="logo-tunisiana"></div>

    </div>
  <div class="frame-body tk-body">
    <div class="zone_battle z_1" id="zone_battle_1">
        <h1 class="name text-s4 color-c1"></h1>
        <div class="zone_1"></div>
    </div>
    <div class="zone_battle z_2" id="zone_battle_2">
        <h1 class="name text-s4 color-c1"></h1>
        <div class="zone_2"></div>
    </div>
  </div>
  <div class="frame-header footer tk-header">
    <div class="logo-ooredoo"></div>
    <div class="logo-tunisiana"></div>
  </div>

</div>
<div id="frame-3" class="frame frame-3 bg-tunisiana-s2 header-in-top frame-sucess" data-frame="3">
        <div class="frame-header tk-header">
          <div class="logo-ooredoo"></div>
          <div class="logo-tunisiana"></div>
        </div><div class="frame-body tk-body">
      <div class="table_wrap allheight">
        <div class="cell_wrap middle">
          <div class="container">
            <div class="container_6">
              <div class="grid_6">
                <div class="box">

                    <div class="quizResults" style="display: block;">
                      <h3 class="quizLevel level4"><span><div class="res" style="background-image:url(/images/iconmonstr-christmas-gift-2-icon.svg)"><span class="txt">Bravo <b class="client"></b> !</span> Vous avez gagné une Recharge de <span class="txt">3 DT.</span></div></span></h3>
                    </div>
                    </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

<section id="zone_chat"> </section>
</div>
<script src="/socket.io/socket.io.js"></script>
<script type="text/javascript" src="/javascripts/jquery/jquery.min.js"></script>
<script type="text/javascript" src="/javascripts/jquery/jquery-ui-1.9.2.custom.min.js"></script>
<script type="text/javascript" src="/javascripts/jquery/jquery.ui.touch-punch.js"></script>
<script type="text/javascript" src="/javascripts/jquery/jquery.placeholder.js"></script>
<script type="text/javascript" src="/javascripts/jquery/jquery.browser.js"></script>
<script type="text/javascript" src="/javascripts/jquery/jquery.hoverIntent.js"></script>
<script type="text/javascript" src="/plugins/vegas/jquery.vegas.js"></script>
<script type="text/javascript" src="/plugins/keyboard/js/keyboard.js"></script>
<script type="text/javascript" src="/plugins/slick-quiz/js/slickQuiz-config.js"></script>
<script type="text/javascript" src="/plugins/slick-quiz/js/slickQuiz.js"></script>
<script type="text/javascript" src="/javascripts/tunisiana/background.js"></script>
<script type="text/javascript" src="/javascripts/script-master.js"></script>
<script>

            
			
			/*$(document).ready(function() {
				// Display the right thumbnail instead of the slideshow animated gif when the slideshow is running
				$( 'body' ).bind( 'vegaswalk', function( e, bg ) {
					var src = $( bg ).attr( 'src' ).replace( 'background', 'thumbnail' );
					$( '#thumbnail' ).attr( 'src', src );
			
				});
			});*/
            // Connexion à socket.io
            var socket = io.connect('http://localhost:8080');

            // On demande le pseudo, on l'envoie au serveur et on l'affiche dans le titre
/*            var pseudo = prompt('Quel est votre pseudo ?');
            socket.emit('nouveau_client', pseudo);
            document.title = pseudo + ' - ' + document.title;*/
            var client_connected = 0,
            client_connected_a = 0,
            client_connected_b = 0,
            currentFrame = 1;


			socket.on('nouveau_client_a', function(data) {
                insereNouveauClient('.zone_1');
                client_connected_a = 1;
                $('#zone_battle_1 .name').text(data);
                fn_client_connected();

            });
			socket.on('nouveau_client_b', function(data) {
                insereNouveauClient('.zone_2');
                client_connected_b = 1;
                $('#zone_battle_2 .name').text(data);
                console.log(data);
                fn_client_connected();
            });

            // Quand on reçoit un message, on l'insère dans la page
            socket.on('message_a', function(data) {
                insereMessage(data.pseudo, data.message, '.zone_1')
            });
			socket.on('message_b', function(data) {
                insereMessage(data.pseudo, data.message, '.zone_2')
            });

			// Quand on reçoit un message, on l'insère dans la page
            socket.on('update_pos_a', function(data) {
                insereHtml(data.pseudo, data.html, '.zone_1')
            });
			socket.on('update_pos_b', function(data) {
                insereHtml(data.pseudo, data.html, '.zone_2')
            });

            socket.on('client_win', function(data) {
                client_win(data.pseudo, data.client)
            });

            // Ajoute un message dans la page
            function insereNouveauClient(zone) {
                $(zone).html('');
            }
			function insereMessage(pseudo, message, zone) {
                $(zone).prepend('<p><strong>' + pseudo + '</strong> ' + message + '</p>');
            }
			function insereHtml(pseudo, html, zone) {
                $(zone).html(html);
            }
            function client_win(pseudo, client){
                $('.client').text(pseudo);
                nextFrame(2,3);
            }
            function fn_client_connected(){
                client_connected++;
                if(client_connected_a == 1 && client_connected_b == 1){
                    client_connected_a = 0;
                    client_connected_b = 0;
                    nextFrame(1,2);
                }
            }
            function nextFrame(nbra,nbr){
             $('.vegas-background').hide();
             tunisiana.log('----------------------------------------------------',true);
             tunisiana.log('                    NextFrame                       ',true);
             tunisiana.log('----------------------------------------------------',true);
             currentFrame = nbra;
             $('#frame-'+currentFrame).css('z-index','90').fadeOut('slow', function(){
                 $(this).hide();
             });
             tunisiana.log('Hide frame'+currentFrame);
             currentFrame = nbr;
             $('#frame-'+currentFrame).css('z-index','10').fadeIn('slow', function(){
                 tunisiana.log('Show frame'+currentFrame);
             });
         };
         $('.quizResults').click(function(){
                location.reload();
         });


        </script>

</body>
</html>
